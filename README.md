# VRChatイベントカレンダー入力支援ツール

VRChatイベントカレンダー (<https://vrceve.com/>) のイベント登録用フォームに、イベント情報を自動入力する Windows 向けツールです。

- イベント情報のフォーム入力を自動化
- GUI でイベント情報や告知テンプレートを管理
- Chrome の専用プロファイルを使って、毎回ログインし直さずに運用

イベント運営の「毎回同じことを書いている」作業をできるだけ減らすことを目的に作成しました。Discord/X 告知文などの定型文を管理する入力フォームもおまけとして実装しています。

GUI 版（EXE）は Booth で配布しており、このリポジトリでは主にソースコードを提供します。

> 本ツールは VRChat / VRChatイベントカレンダー運営様とは一切関係のない、有志による非公式ツールです。

---

## 機能概要

- GUI でイベント情報を入力・保存
- `config.json` に保存された内容をもとに、Google フォームへ自動入力
- 専用 Chrome プロファイルを作成し、以降は同じログイン状態で自動入力を実行
- 追加の変数やテンプレート文（Discord / X 告知文など）を管理する「おまけ」機能

内部的には、以下のスクリプトを GUI から呼び出しています。

- `create_profile.py` … Chrome で専用プロファイルを作成（Google アカウントにログイン）
- `autofill.py` … VRChatイベントカレンダー用フォームを開き、自動入力

---

## 動作環境

- OS: Windows 10 以降
- ブラウザ: Google Chrome
- インターネット接続
- Google アカウント
- Chrome for Testing (初回実行時に自動ダウンロードされます)

ソースコードから実行する場合:

- Python 3.9 以降を推奨
- 主要な依存パッケージ: `selenium (>=4.6.0)`, `psutil`, `PySide6`（詳細は `requirements.txt` を参照）

---

## インストール

### 1. Booth 配布版（EXE）を使う場合（推奨）

1. Booth の配布ページから最新版の ZIP をダウンロードします。
	- 例: `vrc-event-calendar-autofill-v*.*.zip`
2. 任意のフォルダに解凍します。
3. フォルダ内の `VRCカレンダー入力.exe` をダブルクリックして起動します。

> プロファイル用のフォルダ `profile` は、解凍したフォルダ直下に自動で作成されます。配布・共有時はこのフォルダを含めないよう注意してください（ログイン情報が含まれます）。

### 2. ソースコードから実行する場合

1. 本リポジトリをクローンまたは ZIP をダウンロードして展開します。

	```bash
	git clone https://github.com/hamikuma/vrc-event-calendar-autofill.git
	cd vrc-event-calendar-autofill
	```

2. 依存パッケージをインストールします。

	```bash
	pip install -r requirements.txt
	```

3. GUI を起動します。

	```bash
	python gui_main.py
	```

---

## 画面の使い方

GUI には主に次のタブがあります。

### 1. 「入力内容」タブ

- イベント名、日時、主催者、イベント内容などを入力します。
- 必須項目が不足している場合、保存時にエラーが表示されます。
- 入力が終わったら「入力内容保存」ボタンで `config.json` に保存します。

### 2. 「実行 / ログ」タブ

1. **プロファイル作成（初回のみ）**
	- 「プロファイル作成」ボタンを押すと Chrome が起動し、専用プロファイルで開きます。
	- 表示されたブラウザで Google アカウントにログインしてください。
	- ログイン完了後、ブラウザを閉じると、フォルダ直下の `profile` にログイン情報が保存されます。

2. **フォーム自動入力**
	- 「フォーム自動入力」ボタンを押します。
	- VRChatイベントカレンダー用の Google フォームが開き、`config.json` の内容をもとに自動入力を行います。
	- 処理状況やエラーは「ログ」欄に表示されます。

### 3. 「おまけ」タブ

- A〜E の追加変数と、最大 5 件のテンプレート文を設定できます。
- テンプレート文中では、以下のようなプレースホルダを利用できます（例）：
  - `{A}` … 追加変数 A（例: 開催回数）
  - `{START_DATE}` … イベント開始日
  - `{START_TIME}` … イベント開始時刻
- Discord 告知文、X 告知文、Group ポスト文などのテンプレートを登録しておくと便利です。

---

## `config.json` の設定項目

`config.json` は GUI から自動生成・更新されますが、テキストエディタで直接編集することもできます。

代表的なキーの意味は次のとおりです。

| キー | 内容 | 備考 |
| ---- | ---- | ---- |
| `form_url` | 対象となる Google フォームの URL | 通常は変更不要 |
| `record_the_email_address_to_reply` | 返信に表示するメールアドレスをフォームに記録するか | `true` / `false` |
| `event_name` | イベント名 | 文字列 |
| `android_support` | Android 対応可否 | `"PC"` / `"PC/android"` / `"android only"` |
| `start_date` / `end_date` | 開始・終了日 | `YYYYMMDD` / `YYYY-MM-DD` / `YYYY/MM/DD` に加え、`"月曜"〜"日曜"` の曜日キーワードも許容。`start_date` が空欄なら当日、`end_date` が空欄なら開始日と同じ日付（開始日も空欄なら当日）を自動入力 |
| `start_hour` / `start_minute` | 開始時刻 | 例: `"23"`, `"00"` |
| `end_hour` / `end_minute` | 終了時刻 | 例: `"23"`, `"59"` |
| `event_host` | イベント主催者 | 文字列 |
| `event_content` | イベント内容 | 複数行テキスト可 |
| `genres` | イベントジャンル | 文字列の配列（例: `["音楽イベント", "交流会"]`） |
| `participation_conditions` | 参加条件 | 任意 |
| `participation_method` | 参加方法 | 任意 |
| `remarks` | 備考 | 任意 |
| `overseas_announcement` | 海外ユーザー向け告知 | `true` の場合「希望する」を選択 |
| `x_announcement` | X 告知文 | 任意 |

追加機能用のキー:

- `extras.variables.A`〜`E` … 任意の文字列。テンプレート内で `{A}`〜`{E}` として利用可能
- `extras.templates` … テンプレートの配列
  - `title` … テンプレート名（例: "Discord告知文"）
  - `body` … 本文。プレースホルダ `{A}` や `{START_DATE}` などが利用可能
  - `notes` … 備考（URL 等のメモ用）

> `config.json` の保存場所は、GUI 右上（または画面上部）にパスとして表示されます。標準では実行ファイルと同じフォルダ配下に作成されます。

---

## 注意事項
- 初回実行時に、自動入力用ブラウザとして Google 公式の Chrome for Testing をツールと同じフォルダ内に自動ダウンロードします（数百MB程度）
- Google アカウントのログイン情報は、ツールのフォルダ配下の `profile` フォルダに保存されます。他人と共有する際は、このフォルダを含めて配布しないよう注意してください。
- Google フォーム側の仕様変更などにより、将来動作しなくなる可能性があります。
- VRChat および VRChatイベントカレンダーの利用規約・ガイドラインに反しない範囲でご利用ください。

---

## 開発者向けメモ

- 主要スクリプト
  - `gui_main.py` … PySide6 を用いた GUI ランチャー
  - `form_utils.py` … フォーム操作のユーティリティとログ出力
  - `create_profile.py` … Chrome 専用プロファイルの作成
  - `autofill.py` … フォーム自動入力本体
- 依存ライブラリは `requirements.txt` を参照してください。

---

## 更新履歴（抜粋）

- 2026/01/30: GUI の実装、テンプレート機能の追加
- 2025/08/31: 安定性向上、自動終了処理を追加
- 2025/06/15: プロファイルを `config.json` で指定する方式から、実行フォルダ配下で生成する方式に変更
- 2025/05/16: パッケージ化対応

ご要望・不明点・改善点などあれば、Issue の作成や Pull Request、X 等でお気軽にご連絡ください。

ライセンスについては `LICENSE` を参照してください。
